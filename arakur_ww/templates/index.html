{% extends "bootstrap_responsive.html" %}

{% block style %}
<link href="{{url_for('static', filename='bootstrap.min.css')}}" rel="stylesheet">
<link href="{{url_for('static', filename='base.css')}}" rel="stylesheet">
{% endblock %}

{% block body_content %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="{{url_for('static', filename='event_manager.js')}}"></script>
<script type="text/javascript">
(function(){  
    first_load = true;  

    function update(state){
        update_bar("turbiedad", state.instant_values.cloudiness, "NTU");   
        update_bar("nivel", state.instant_values.level, "%");   
        update_bar("oxigeno", state.instant_values.oxigen, "mg/Litro");
        if (first_load){
            for(var i = 0; i < state.alarms.length; i++){
                set_alert(state.alarms[i]);                
                };
            for(var i = 0; i < state.events.length; i++){
                set_notify(state.events[i]);                
                };
            first_load = false;
        } else {
            for(var i = 0; i < state.new_alarms.length; i++){
                set_alert(state.new_alarms[i]);                
            }; 
            for(var i = 0; i < state.new_events.length; i++){
                set_notify(state.new_events[i]);                
            };
}; 
    };
    state_handler(update);
})();

</script>

<div class="container">
  <ul class="nav nav-tabs">
    <li class='active'> 
    <a href='#'>Dashboard</a>
    </li>

    <li> 
    <a href='/graficos'>Graficos</a>
    </li>

    <li> 
    <a href='/admin'>Admin</a>
    </li>
  </ul>
  
  <div class="row">
    <div class="span6">
      <h3> Valores Actuales </h3>
      <h4> Nivel en SBR </h4>
      <div class="progress progress-info progress-striped">
        <div id="nivel" class="bar" style="width: 20%">20%</div>
      </div>  
      <h4> Oxigeno </h4>
      <div class="progress progress-info progress-striped">
        <div id="oxigeno" class="bar" style="width: 20%"> 27 mg/Litro</div>
      </div>  
      <h4> Turbiedad </h4>
      <div class="progress progress-info progress-striped">
        <div id="turbiedad" class="bar" style="width: 20%">42 NTU</div>
    </div> </div>
    <div class="span3">
      <h3> Volumen Acumulado </h3>
      <h4> Total</h4>
      50 m3
      <h4> Parcial </h4>
      22 m3
      <input type="button" class="btn btn-primary btn-block" value="Reset Parcial"/>
    </div>
    <div class="span3">
        <h3> Tiempos </h3>
        <h4> Carga Aireada </h4>
        <div id="tiempo_carga_aireada">50 minutos</div>
        <h4> Aireación </h4>
        <div id="tiempo_aireacion">50 minutos</div>
        <h4> Sedimentación </h4>
        <div id="tiempo_sedimentacion">50 minutos</div>
        <h4> Descarga </h4>
        <div id="tiempo_descarga">50 minutos</div>

    </div>
  </div>
  <div class="row">
    <div class="span6">
      <h3> Alarmas </h3>
      <input type="button" class="btn btn-primary btn-block" value="Detener alarma acustica"/>
      <div id='alert_container'>
      </div>
    </div>
    <div class="span6">
      <h3> Eventos </h3>
      <div id="event_container" height="50%" style="overflow: auto;">
      </div>
    </div>
  </div>
</div>

{% endblock %}
